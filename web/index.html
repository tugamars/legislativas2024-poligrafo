 <!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Quem mais mente?</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
	
	<style>
	.fill { 
		min-height: 100%;
		height: 100%;
	}
	
	.evaluation-img {
		max-width: 75px;
	}
	
	th, td {
		text-align: center;
	}
	
	.text-left {
		text-align:left;
	}
	
	.stripped {
		background-color: #2c3034!important;
	}
	
	.score {
		font-weight: bold;
		font-size: 1.5em;
	}
	
	.candidato-img {
		height: 75px;
	}
	.partido-img {
		height: 50px;
	}
	</style>
  </head>

<body class="bg-dark">

<div class="container-fluid fill">
	<div class="row mt-5">
		<h1 class="text-white text-center">Quem mais mente? - Debates 2024</h1>
	</div>
	<div class="row mt-5">
		<div class="col-md-1 d-sm-none d-md-block"></div>
		<div class="col-md-10 col-sm-12">
			
			<table class="table table-dark table-hover align-middle">
			  <thead>
				<tr>
				  <th scope="col" colspan="2" id="last-update"></th>
				  <th scope="col" colspan="2" class="text-center stripped">
					<img src="assets/evaluation/true.png" class="evaluation-img">
				  </th>
				  <th scope="col" colspan="2" class="text-center">
					<img src="assets/evaluation/true-but.png" class="evaluation-img">
				  </th>
				  <th scope="col" colspan="2" class="text-center stripped">
					<img src="assets/evaluation/imprecise.png" class="evaluation-img">
				  </th>
				  <th scope="col" colspan="2" class="text-center">
					<img src="assets/evaluation/decontextualized.png" class="evaluation-img">
				  </th>
				  <th scope="col" colspan="2" class="text-center stripped">
					<img src="assets/evaluation/false.png" class="evaluation-img">
				  </th>
				  <th scope="col" colspan="2" class="text-center">
					<img src="assets/evaluation/manipulated.png" class="evaluation-img">
				  </th>
				  <th class="stripped">Pontuação Abs.</th>
				  <th>Total Artigos</th>
					<th class="stripped">Pontuação/Artigo</th>
				</tr>
				<tr>
					<th>Candidato</th>
					<th>Partido</th>
					<th class="stripped">Abs.</th>
					<th class="stripped">Perc.</th>
					<th>Abs.</th>
					<th>Perc.</th>
					<th class="stripped">Abs.</th>
					<th class="stripped">>Perc.</th>
					<th>Abs.</th>
					<th>Perc.</th>
					<th class="stripped">Abs.</th>
					<th class="stripped">>Perc.</th>
					<th>Abs.</th>
					<th>Perc.</th>
					<th class="stripped"></th>
					<th></th>
					<th class="stripped"></th>
				</tr>
			  </thead>
			  <tbody id="candidatos-body">

			  </tbody>
			</table>
		
		</div>
		<div class="col-md-1 d-sm-none d-md-block"></div>
	</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
<script type="text/javascript">

const PARTIDOS={
	"il":"Iniciativa Liberal",
	"l":"Livre",
	"ps":"Partido Socialista",
	"ad":"Aliança Democrática",
	"be":"Bloco de Esquerda",
	"ch":"Chega",
	"cdu":"Coligação Democrática Unitária",
	"pan":"Pessoas-Animais-Natureza",
};

function percCalc(value, total){
	return ((100 * value) / total).toFixed(0)+"%";
}
function loadCandidato(c){
	console.log(c);
	let imgC="assets/candidatos/"+c.candidato.toLowerCase()+".png";
	let imgP="assets/partidos/"+c.partido.toLowerCase()+".png";

	let total=0;
	for(k in c.sum){
		total+=c.sum[k];
	}

	let s='<tr>\n' +
	'\t\t\t\t  <th scope="row" class="text-left"> <img src="'+imgC+'" class="candidato-img"> '+c.nome +' </th>\n' +
	'\t\t\t\t  <td class="text-left"> <img src="'+imgP+'" class="partido-img"> '+PARTIDOS[c.partido.toLowerCase()] +' </th>\n' +
	'\t\t\t\t  <td class="stripped">'+(c.sum.true ?? 0)+'</td>\n' +
	'\t\t\t\t  <td class="stripped">'+percCalc((c.sum.true ?? 0),total)+'</td>\n' +
	'\t\t\t\t  <td>'+(c.sum["true-but"] ?? 0)+'</td>\n' +
	'\t\t\t\t  <td>'+percCalc((c.sum["true-but"] ?? 0),total)+'</td>\n' +
	'\t\t\t\t  <td class="stripped">'+(c.sum.imprecise ?? 0)+'</td>\n' +
	'\t\t\t\t  <td class="stripped">'+percCalc((c.sum.imprecise ?? 0),total)+'</td>\n' +
	'\t\t\t\t  <td>'+(c.sum["decontextualized"] ?? 0)+'</td>\n' +
	'\t\t\t\t  <td>'+percCalc((c.sum["decontextualized"] ?? 0),total)+'</td>\n' +
	'\t\t\t\t  <td class="stripped">'+(c.sum.false ?? 0)+'</td>\n' +
	'\t\t\t\t  <td class="stripped">'+percCalc((c.sum.false ?? 0),total)+'</td>\n' +
	'\t\t\t\t  <td>'+(c.sum["manipulated"] ?? 0)+'</td>\n' +
	'\t\t\t\t  <td>'+percCalc((c.sum["manipulated"] ?? 0),total)+'</td>\n' +
	'\t\t\t\t  <td class="stripped score text-warning">'+(0-c.points)+'</td>\n' +
	'\t\t\t\t  <td class="score text-info">'+total+'</td>\n' +
	'\t\t\t\t  <td class="stripped score text-warning">'+parseFloat((0-c.points)/total).toFixed(2)+'</td>\n' +
	'\t\t\t\t</tr>';

	$("#candidatos-body").append(s);
}

$(document).ready(function(){
	fetch("data/fact-checks-processed.json")
			.then(response => response.json())
			.then(function(response) {
				$("#last-update").html("Última atualização:<br>" + new Date(response.lastUpdate).toLocaleString());
				let res = Object.values(response.candidatos).sort((a, b) => (b.points/b.totalArtigos)-(a.points/a.totalArtigos));
				for(k in res){
					loadCandidato(res[k]);
				}
			})
			.catch(function(error) {
				console.log(error);
			});
});

</script>

</body>
</html> 